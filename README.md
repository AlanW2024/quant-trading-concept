好的，這是在 Canvas 中的內容，已為您整理成標準的 Markdown 格式，方便您複製使用。

````markdown
# 一個量化策略的進化、失敗與頓悟 (2015-2024)

## 專案起源 (The Genesis)

本專案始於一個簡單的問題：我們能否將產業專家在訪談中提出的宏觀洞見，轉化為一個可執行的、由數據驗證的量化交易策略？

研究起點是一部由 Anson Tan 對談量化交易專家 Dr. Ernest P. Chan 的 [YouTube 影片](https://youtu.be/i-o1GXjMYrY)。核心假說圍繞著**聯準會升息**與**市場恐慌情緒 (VIX)** 對科技股 (QQQ) 的潛在影響。

這個儲存庫記錄了從一個模糊的想法，到一個複雜策略的完整進化路徑。它不是一個成功案例的展示，而是一份關於**策略迭代、連續失敗、以及從失敗中提煉深刻洞見**的真實研究日誌。

---

## 研究日誌：一個策略的 10 個進化層級

我們的研究遵循了一條嚴謹的、從觀察到回測的科學路徑。每一個層級的策略，都是對前一個層級失敗的修正與進化。

### Level 1: 現象觀察 (Observation)

- **假說：** 聯準會升息，是否會對科技股 (QQQ) 造成比大盤 (SPY) 更大的衝擊？
- **方法：** 執行事件研究，分析升息前後 30 天的平均報酬率與波動率。
- **腳本：** `analyze_fed_hike_impact.py`
- **結論：** 假說成立。數據證實，升息期間 QQQ 的波動性顯著高於 SPY。

### Level 2: 引入背景 (Context)

- **假說：** 市場的背景情緒，是否會改變市場對升息的反應？
- **方法：** 引入 VIX 指數，將升息事件分為「高恐慌 (VIX > 25)」與「低恐慌」兩組，進行對比分析。
- **腳本：** `analyze_fed_hike_by_vix.py`
- **結論：** 假說成立。升息本身不是利空，而是市場情緒的放大器。在低 VIX 時市場反應平淡，在高 VIX 時則引發劇烈拋售。

### Level 3: 首次回測 (Passive Hedging)

- **假說：** 一個懂得在「高 VIX + 升息」的危險時刻退回現金的策略，能否超越無腦持有？
- **方法：** 建立第一個回測引擎，策略在觸發風險時清倉，持有現金 30 天。
- **腳本：** `backtest_vix_timing_strategy.py`
- **結論：** **策略慘敗。** 雖然成功避開了風險，但因在場外時間過長，完美錯過了過去十年的牛市。**教訓：機會成本是真實的。**

### Level 4: 主動防禦 (Defensive Rotation)

- **假說：** 與其退回現金，不如在危險時刻將資金從 QQQ **輪動到**傳統避險資產（黃金 GLD），能否改善績效？
- **方法：** 修改回測引擎，在觸發風險時賣出 QQQ，買入 GLD 並持有 30 天。
- **腳本：** `backtest_defensive_rotation_strategy.py`
- **結論：** **首次成功！** 策略在總回報上略微超越基準，同時顯著降低了波動率與最大回撤，獲得了更高的夏普比率。**我們發現了真正的 Alpha。**

### Level 5-8: 對出場機制的痛苦探索 (The Exit Problem)

- **假說：** 我們能否設計出一個比「固定持有 30 天」更聰明的出場機制？
- **方法：** 分別測試了基於 VIX 指數、移動平均線、以及兩者結合的「雙重確認」動態出場機制。
- **腳本：** `backtest_dynamic_exit_strategy.py`, `backtest_momentum_exit_strategy.py`, `backtest_confirmation_exit_strategy.py`
- **結論：** **全部失敗。** 所有試圖變得「更聰明」的複雜規則，都因為反應過慢或過於敏感，導致了災難性的「兩面挨耳光 (Whipsaw)」，績效遠遜於 Level 4 的簡單規則。**教訓：過度優化是 Alpha 的殺手。**

### Level 9: 參數優化 (Optimization)

- **假說：** Level 4 策略的成功，是否只是因為幸運地猜對了「30 天」？它的 Alpha 是否穩健？
- **方法：** 對 Level 4 策略的 `HOLDING_PERIOD` 參數進行系統性的掃描測試（從 10 天到 90 天）。
- **腳本：** `optimize_holding_period.py`
- **結論：** **策略極度穩健。** 績效並非一個尖銳的山峰，而是一個從 30 天到 60 天都表現優異的「平坦高原」。數據證明 Alpha 是真實存在的，最佳甜蜜點約在 **50 天**。

### Level 10 & 畢業考: 典範轉移的診斷 (The Regime Shift)

- **假說：** 我們的最佳策略 (Level 4, 50 天) 為何在 2022 年之後的歷史回測中表現掙扎？是否因為市場的宏觀典範發生了轉移？
- **方法：** 將數據以 2022 年為切點，進行樣本內與樣本外測試，並最終測試了「現金為王」的終極避險策略。
- **腳本：** `diagnose_regime_shift.py`, `backtest_cash_is_king_strategy.py`
- **結論：** **典範轉移被證實。** 策略在 2022 年前的「低通膨、低利率」時代表現優異，但在 2022 年後的「高通膨、高利率」時代，其核心避險資產（黃金、債券）的避險屬性暫時失效，導致策略失靈。

---

## 最終頓悟 (The Ultimate Conclusion)

這個專案最珍貴的產出，不是一個能賺錢的策略，而是下面這條血的教訓：

**所有基於歷史數據的 Alpha，都隱含著對「宏觀典範 (Macro Regime)」持續不變的假設。當典範轉移時，昨日的聖杯，可能就是明日的毒藥。**

一個成功的量化交易者，其核心能力不是找到一個完美的策略，而是：

1.  深刻理解自己策略的**適用邊界**與**內在弱點**。
2.  建立一套能**監測宏觀典範**是否正在轉移的系統。
3.  擁有在必要時，**果斷拋棄舊策略**的紀律與勇氣。

---

## 如何使用這個儲存庫

1.  安裝必要的 Python 函式庫:
    ```bash
    pip install yfinance pandas numpy matplotlib seaborn
    ```
2.  按照 `Level 1` 到 `Level 10` 的順序，依次執行 `*.py` 腳本。
3.  仔細閱讀每個腳本中的註解，並對比回測結果，親身體驗策略的進化與失敗。

---

## 免責聲明

本儲存庫所有內容僅供學術研究與教育目的使用，不構成任何形式的投資建議。所有回測結果均基於歷史數據，歷史績效不代表未來回報。金融市場充滿風險，請自行承擔交易決策的後果。
````
